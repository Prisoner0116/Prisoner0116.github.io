---
layout: post
title: 加密解密学习笔记
category: blog
description:  加密解密、公钥加密技术PKI、非对称加密算法RSA、签名验签、PKCS标准、UsbKey
---


### 加密解密概念

加密技术是最常用的安全保密手段，利用技术手段把重要的数据变为乱码（加密）传送，到达目的地后再用相同或不同的手段还原（解密）。

### 公钥加密技术PKI
	
PKI（Public Key Infrastructure）是一个用非对称密码算法原理和技术来实现并提供安全服务的具有通用性的安全基础设施，是一种遵循标准的利用公钥加密技术为网上电子商务、电子政务的开展，提供一整套安全的基础平台。PKI，公钥基础设施，顾名思义，PKI技术就是利用公钥理论和技术建立的提供网络信息安全服务的基础设施。PKI管理平台能够为网络中所有需要采用加密和数字签名等密码服务的用户提供所需的密钥和证书管理，用户可以利用PKI平台提供的安全服务进行安全通信。

PKI公开密钥基础设施能够让应用程序增强自己的数据和资源的安全，以及与其他数据和资源交换中的安全。使用PKI安全基础设施像将电器插入墙上的插座一样简单。

#### PKI内容

一个完整的PKI系统必须具备权威认证机构（CA）、数字证书库、密钥备份及恢复系统、证书作废系统和应用接口（API）等基本组成部分。

1、权威认证机构（Certificate Authority）：权威认证机构简称CA，是PKI的核心组成部分，也称作认证中心。它是数字证书的签发机构。CA是PKI的核心，是PKI应用中权威的、可信任的、公正的第三方机构。

2、数字证书库：在使用公钥体制的网络环境中，必须向公钥的使用者证明公钥的真实合法性。因此，在公钥体制环境中，必须有一个可信的机构来对任何一个主体的公钥进行公证，证明主体的身份以及它与公钥的匹配关系。目前较好的解决方案是引进证书(Certificate)机制。

* 证书。证书是公开密钥体制的一种密钥管理媒介。它是一种权威性的电子文档，形同网络环境中的一种身份证，用于证明某一主体的身份以及其公开密钥的合法性。

* 证书库。证书库是证书的集中存放地，是网上的一种公共信息库，供广大公众进行开放式查询。到证书库访问查询，可以得到想与之通信实体的公钥。证书库是扩展PKI系统的一个组成部分，CA的数字签名保证了证书的合法性和权威性。

3、密钥备份及恢复系统：如果用户丢失了密钥，会造成已经加密的文件无法解密，引起数据丢失，为了避免这种情况，PKI提供密钥备份及恢复机制。

4、证书作废系统：有时因为用户身份变更或者密钥遗失，需要将证书停止使用，所以提供证书作废机制。

5、PKI应用接口系统： PKI应用接口系统是为各种各样的应用提供安全、一致、可信任的方式与PKI交互，确保所建立起来的网络环境安全可信，并降低管理成本。没有PKI应用接口系统，PKI就无法有效地提供服务。
　
整个PKI系统中，只有CA会和普通用户发生联系，其他所有部分对用户来说都是透明的。

参考Alice和Bob的故事 [Alice and Bob] 

### 非对称加密算法RSA

参考 [阮一峰的博客]

### PKCS标准

参考维基百科[PKCS维基百科]

### UsbKey

一般来说，USBKey有：

* 一个唯一的序列号（SN）。
* 有您的数字证书，数字证书含有您的公钥信息和CA对该证书的签名值。
* 您数字证书对应的私钥。

CA的公钥一般不保存在USBKey里，而在安装包程序里，在安装的时候，安装包会向系统注册您数字证书的CA的证书。

证书的申请流程大致如此：

* USBKey内部产生RSA密钥对。[CSP]
* 将个人信息，密钥对的公钥，HASH算法等组成的数据使用密钥对的私钥签名，填充P10格式的数据提交给CA。
* CA针对P10数据审核，再使用CA的私钥对该P10签名，组合成证书数据。
* 客户端保存证书数据，成为客户证书。

用户的公钥保存在数字证书里有体现，但一般也会在USBKey内部单独保存一个公钥数据。
CA的私钥是用来签发客户证书用的。
用户登录网银一般是做的双向认证，CA会给网银服务器颁发一个服务器证书，客户端首先会验证服务器证书，再用客户端证书与服务器协商一个SSL通讯用的对称密钥，来保证数据数据通讯过程的安全。

[Alice and Bob]: http://mp.weixin.qq.com/s/9V1PW9fBXBaOsa7E_JJdNA
[阮一峰的博客]: http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html
[PKCS维基百科]:https://en.wikipedia.org/wiki/PKCS
[CSP]:https://en.wikipedia.org/wiki/Cryptographic_Service_Provider